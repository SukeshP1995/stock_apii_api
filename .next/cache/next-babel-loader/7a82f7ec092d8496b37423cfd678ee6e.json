{"ast":null,"code":"import { randomBytes } from \"crypto\";\nexport default (async (req, res) => {\n  try {\n    var rows = req.query.number;\n    const code = randomBytes(8).toString('hex');\n    ; // await Promise.all(rows.map(async (row) => {\n    //   await StockUser.updateOne({_id: row[2]}, {$set: { code: code }}, {upsert : true, setDefaultsOnInsert: true});\n    // }));\n\n    res.status(200).send(code);\n  } catch (error) {\n    res.status(502).send(error);\n  }\n});","map":{"version":3,"sources":["D:/code/stock_api/pages/api/stockusers/add.ts"],"names":["randomBytes","req","res","rows","query","number","code","toString","status","send","error"],"mappings":"AAEA,SAAQA,WAAR,QAA0B,QAA1B;AAEA,gBAAe,OAAOC,GAAP,EAAwBC,GAAxB,KAA6C;AAC1D,MAAI;AACF,QAAIC,IAAI,GAAGF,GAAG,CAACG,KAAJ,CAAUC,MAArB;AACA,UAAMC,IAAI,GAAGN,WAAW,CAAC,CAAD,CAAX,CAAeO,QAAf,CAAwB,KAAxB,CAAb;AAA4C,KAF1C,CAIF;AACA;AACA;;AAEAL,IAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBH,IAArB;AACD,GATD,CASE,OAAOI,KAAP,EAAc;AACdR,IAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBC,KAArB;AACD;AAEF,CAdD","sourcesContent":["import { NowRequest, NowResponse } from '@now/node'\r\nimport StockUser from '../../../models/stockuser.model'\r\nimport {randomBytes} from \"crypto\"\r\n\r\nexport default async (req: NowRequest, res: NowResponse) => {\r\n  try {\r\n    var rows = req.query.number;\r\n    const code = randomBytes(8).toString('hex');;\r\n\r\n    // await Promise.all(rows.map(async (row) => {\r\n    //   await StockUser.updateOne({_id: row[2]}, {$set: { code: code }}, {upsert : true, setDefaultsOnInsert: true});\r\n    // }));\r\n\r\n    res.status(200).send(code);\r\n  } catch (error) {\r\n    res.status(502).send(error);\r\n  }\r\n  \r\n}"]},"metadata":{},"sourceType":"module"}