{"ast":null,"code":"import StockUser from '../../../../models/stockuser.model';\nexport default (async (req, res) => {\n  try {\n    var number = req.body.number;\n    const user = (await StockUser.find({\n      \"_id\": number\n    }))[0];\n    console.log(user);\n\n    if (user.code == req.body.code && !user.signed) {\n      await StockUser.updateOne({\n        _id: number\n      }, {\n        $set: {\n          signed: true\n        }\n      }, {\n        upsert: true,\n        setDefaultsOnInsert: true\n      });\n      res.status(200).send(\"success\");\n    } else res.status(400).send(\"failed\");\n  } catch (error) {\n    res.status(502).send(error);\n  }\n});","map":{"version":3,"sources":["D:/code/stock_api/pages/api/units/users/log.ts"],"names":["StockUser","req","res","number","body","user","find","console","log","code","signed","updateOne","_id","$set","upsert","setDefaultsOnInsert","status","send","error"],"mappings":"AACA,OAAOA,SAAP,MAAsB,oCAAtB;AAEA,gBAAe,OAAOC,GAAP,EAAwBC,GAAxB,KAA6C;AAC1D,MAAI;AACF,QAAIC,MAAM,GAAGF,GAAG,CAACG,IAAJ,CAASD,MAAtB;AACA,UAAME,IAAI,GAAG,CAAC,MAAML,SAAS,CAACM,IAAV,CAAe;AAAC,aAAOH;AAAR,KAAf,CAAP,EAAwC,CAAxC,CAAb;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAYH,IAAZ;;AACA,QAAKA,IAAI,CAACI,IAAL,IAAaR,GAAG,CAACG,IAAJ,CAASK,IAAvB,IAAgC,CAACJ,IAAI,CAACK,MAA1C,EAAiD;AAC7C,YAAMV,SAAS,CAACW,SAAV,CAAoB;AAACC,QAAAA,GAAG,EAAET;AAAN,OAApB,EAAmC;AAACU,QAAAA,IAAI,EAAE;AAAEH,UAAAA,MAAM,EAAE;AAAV;AAAP,OAAnC,EAA6D;AAACI,QAAAA,MAAM,EAAG,IAAV;AAAgBC,QAAAA,mBAAmB,EAAE;AAArC,OAA7D,CAAN;AACAb,MAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,SAArB;AACH,KAHD,MAIKf,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,QAArB;AACN,GATD,CASE,OAAOC,KAAP,EAAc;AACdhB,IAAAA,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBC,KAArB;AACD;AAEF,CAdD","sourcesContent":["import { NowRequest, NowResponse } from '@now/node'\r\nimport StockUser from '../../../../models/stockuser.model'\r\n\r\nexport default async (req: NowRequest, res: NowResponse) => {\r\n  try {\r\n    var number = req.body.number;\r\n    const user = (await StockUser.find({\"_id\": number}))[0];\r\n    console.log(user);\r\n    if ((user.code == req.body.code) && !user.signed){\r\n        await StockUser.updateOne({_id: number}, {$set: { signed: true }}, {upsert : true, setDefaultsOnInsert: true});\r\n        res.status(200).send(\"success\");\r\n    }\r\n    else res.status(400).send(\"failed\");\r\n  } catch (error) {\r\n    res.status(502).send(error);\r\n  }\r\n  \r\n}"]},"metadata":{},"sourceType":"module"}