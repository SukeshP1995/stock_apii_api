{"ast":null,"code":"import StockUser from '../../../../models/stockuser.model';\nimport { randomBytes } from \"crypto\";\nexport default (async (req, res) => {\n  try {\n    const code = randomBytes(12).toString('hex');\n    ;\n    await StockUser.updateOne({\n      _id: req.query.number\n    }, {\n      $set: {\n        code: code\n      }\n    }, {\n      upsert: true,\n      setDefaultsOnInsert: true\n    });\n    res.status(200).send(code);\n  } catch (error) {\n    res.status(502).send(error);\n  }\n});","map":{"version":3,"sources":["D:/code/stock_api/pages/api/units/stockusers/add.ts"],"names":["StockUser","randomBytes","req","res","code","toString","updateOne","_id","query","number","$set","upsert","setDefaultsOnInsert","status","send","error"],"mappings":"AACA,OAAOA,SAAP,MAAsB,oCAAtB;AACA,SAAQC,WAAR,QAA0B,QAA1B;AAEA,gBAAe,OAAOC,GAAP,EAAwBC,GAAxB,KAA6C;AAC1D,MAAI;AACF,UAAMC,IAAI,GAAGH,WAAW,CAAC,EAAD,CAAX,CAAgBI,QAAhB,CAAyB,KAAzB,CAAb;AAA6C;AAE7C,UAAML,SAAS,CAACM,SAAV,CAAoB;AAACC,MAAAA,GAAG,EAAEL,GAAG,CAACM,KAAJ,CAAUC;AAAhB,KAApB,EAA6C;AAACC,MAAAA,IAAI,EAAE;AAAEN,QAAAA,IAAI,EAAEA;AAAR;AAAP,KAA7C,EAAqE;AAACO,MAAAA,MAAM,EAAG,IAAV;AAAgBC,MAAAA,mBAAmB,EAAE;AAArC,KAArE,CAAN;AAEAT,IAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBV,IAArB;AACD,GAND,CAME,OAAOW,KAAP,EAAc;AACdZ,IAAAA,GAAG,CAACU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBC,KAArB;AACD;AAEF,CAXD","sourcesContent":["import { NowRequest, NowResponse } from '@now/node'\r\nimport StockUser from '../../../../models/stockuser.model'\r\nimport {randomBytes} from \"crypto\"\r\n\r\nexport default async (req: NowRequest, res: NowResponse) => {\r\n  try {\r\n    const code = randomBytes(12).toString('hex');;\r\n\r\n    await StockUser.updateOne({_id: req.query.number}, {$set: { code: code }}, {upsert : true, setDefaultsOnInsert: true});\r\n\r\n    res.status(200).send(code);\r\n  } catch (error) {\r\n    res.status(502).send(error);\r\n  }\r\n  \r\n}"]},"metadata":{},"sourceType":"module"}